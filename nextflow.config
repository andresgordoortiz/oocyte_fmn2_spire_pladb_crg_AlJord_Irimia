profiles {
    slurm {
        process {
            executor = 'slurm'
            queue = 'genoa64'

            // Adding processes from main.nf with their specific resource requirements
            withName: download_reads {
                memory = '5 GB'
                time = '3m'
                cpu = 1
            }

            withName: concatenate_reads {
                memory = '4 GB'
                time = '30m'
                cpu = 1
            }

            withName: run_fastqc {
                memory = '5 GB'
                time = '60m'
                cpu = 8
                container = 'docker://biocontainers/fastqc:v0.11.9_cv8'
            }

            withName: align_reads {
                memory = '50 GB'
                time = '120m'
                cpu = 8
                container = 'docker://andresgordoortiz/vast-tools:latest'
            }

            withName: combine_results {
                memory = '10 GB'
                time = '40m'
                container = 'docker://andresgordoortiz/vast-tools:latest'
            }

            clusterOptions = {
                switch (task.time) {
                    case { it > 168.h } :
                        return '--qos=ethernal'
                    case (48<..168).h:
                        return '--qos=marathon'
                    case (24<..48).h:
                        return '--qos=vlong'
                    case (12<..24).h:
                        return '--qos=long'
                    case (6<..12).h:
                        return '--qos=normal'
                    case (3<..6).h:
                        return '--qos=short'
                    case (1<..3).h:
                        return '--qos=shorter'
                    default:
                        return '--qos=vshort'
                }
            }
        }

        singularity {
            enabled = true
            autoMounts = true
        }
    }

    local {
        process {
            executor = 'local'

            // Global resource limits for local execution
            cpus = Runtime.runtime.availableProcessors()
            memory = 10.GB

            // Process-specific settings with adjusted resources
            withName: download_reads {
                memory = '2 GB'
            }

            withName: concatenate_reads {
                memory = '2 GB'
            }

            withName: run_fastqc {
                memory = '4 GB'
                container = 'biocontainers/fastqc:v0.11.9_cv8'
            }

            withName: align_reads {
                memory = '10 GB'
                container = 'andresgordoortiz/vast-tools:latest'
            }

            withName: combine_results {
                memory = '8 GB'
                container = 'andresgordoortiz/vast-tools:latest'
            }
        }

        docker {
            enabled = true
        }
    }
}
